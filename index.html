<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Pizza Order</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
    }
    .product-card {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
      border-radius: 8px;
      background: #fafafa;
      cursor: pointer;
    }
    .product-card img {
      width: 100%; max-width: 150px; height: auto;
    }
    .modal {
      display: none; position: fixed; top: 0; left: 0;
      width: 100%; height: 100%; background: rgba(0,0,0,0.6);
      justify-content: center; align-items: center;
    }
    .modal-content {
      background: #fff; padding: 20px; border-radius: 8px;
      width: 350px;
    }
    .close { float: right; cursor: pointer; font-size: 20px; }
    .variant-row { display: flex; justify-content: space-between; align-items: center; margin: 8px 0; }
    #order-summary { border: 1px solid #ddd; padding: 10px; min-height: 50px; background: #f9f9f9; }
    button.add-btn { margin-left: 5px; }
  </style>
</head>
<body>
  <h1>Pizza Order</h1>

  <!-- Product Grid -->
  <div id="product-grid" class="grid"></div>

  <!-- Order Summary -->
  <h2>Your Order</h2>
  <div id="order-summary"></div>
  <p><strong>Total Quantity:</strong> <span id="total-qty">0</span></p>
  <p><strong>Total Price:</strong> ₦<span id="total-price">0</span></p>

  <!-- User Details -->
  <h2>Your Details</h2>
  <form id="order-form">
    <label>First Name: <input type="text" id="first-name" required></label><br><br>
    <label>Last Name: <input type="text" id="last-name" required></label><br><br>
    <label>Phone Number: <input type="text" id="phone" required></label><br><br>
    <label>Child’s Class: <input type="text" id="class" required></label><br><br>
    <button type="submit">Submit Order</button>
  </form>

  <!-- Modal -->
  <div id="product-modal" class="modal">
    <div class="modal-content">
      <span id="close-modal" class="close">&times;</span>
      <img id="modal-image" src="" alt="" style="max-width:100%">
      <h3 id="modal-name"></h3>
      <p id="modal-price"></p>
      <div id="modal-variants"></div>
    </div>
  </div>

  <script>
    // === Product Data (all 30 products) ===
    const products = [
      {name:"Margherita",image:"images/margherita.png",basePrice:8600,variants:[
        {size:"Medium",price:8600},{size:"Large",price:12200},{size:"X-Large",price:17500}]},
      {name:"BBQ MeatBall",image:"images/bbq-meatball.png",basePrice:9600,variants:[
        {size:"Medium",price:9600},{size:"Large",price:13400},{size:"X-Large",price:18800}]},
      {name:"Pepperoni Supreme",image:"images/pepperoni-supreme.png",basePrice:9600,variants:[
        {size:"Medium",price:9600},{size:"Large",price:13400},{size:"X-Large",price:18800}]},
      {name:"Southern Style BBQ Chicken",image:"images/southern-style-bbq-chicken.png",basePrice:10500,variants:[
        {size:"Medium",price:10500},{size:"Large",price:13900},{size:"X-Large",price:19900}]},
      {name:"BBQ Chicken",image:"images/bbq-chicken.png",basePrice:10050,variants:[
        {size:"Medium",price:10050},{size:"Large",price:13900},{size:"X-Large",price:19900}]},
      {name:"Chicken Suya",image:"images/chicken-suya.png",basePrice:10050,variants:[
        {size:"Medium",price:10050},{size:"Large",price:13900},{size:"X-Large",price:19900}]},
      {name:"Chicken Supreme",image:"images/chicken-supreme.png",basePrice:10050,variants:[
        {size:"Medium",price:10050},{size:"Large",price:13900},{size:"X-Large",price:19900}]},
      {name:"BBQ Mega Meat",image:"images/bbq-mega-meat.png",basePrice:10500,variants:[
        {size:"Medium",price:10500},{size:"Large",price:15400},{size:"X-Large",price:21700}]},
      {name:"Shawarma",image:"images/shawarma.png",basePrice:10500,variants:[
        {size:"Medium",price:10500},{size:"Large",price:15400},{size:"X-Large",price:21700}]},
      {name:"Naija Fiesta",image:"images/naija-fiesta.png",basePrice:10500,variants:[
        {size:"Medium",price:10500},{size:"Large",price:15400},{size:"X-Large",price:21700}]},
      {name:"Cheesy Bread",image:"images/cheesy-bread.png",basePrice:4000,variants:[
        {size:"Standard",price:4000}]},
      {name:"Cheesy Sausage Bread",image:"images/cheesy-sausage-bread.png",basePrice:5000,variants:[
        {size:"Standard",price:5000}]},
      {name:"Cheesy Chicken Suya",image:"images/cheesy-chicken-suya.png",basePrice:5000,variants:[
        {size:"Standard",price:5000}]},
      {name:"Cheesy Grilled Chicken",image:"images/cheesy-grilled-chicken.png",basePrice:5000,variants:[
        {size:"Standard",price:5000}]},
      {name:"BBQ Sauce Calzone",image:"images/bbq-sauce-calzone.png",basePrice:8000,variants:[
        {size:"Standard",price:8000}]},
      {name:"Pizza Sauce Calzone",image:"images/pizza-sauce-calzone.png",basePrice:8000,variants:[
        {size:"Standard",price:8000}]},
      {name:"Suya Sauce Calzone",image:"images/suya-sauce-calzone.png",basePrice:8000,variants:[
        {size:"Standard",price:8000}]},
      {name:"Roasted Chicken 2pcs",image:"images/roasted-chicken-2pcs.png",basePrice:4000,variants:[
        {size:"2pcs",price:4000}]},
      {name:"Roasted Chicken 5pcs",image:"images/roasted-chicken-5pcs.png",basePrice:9000,variants:[
        {size:"5pcs",price:9000}]},
      {name:"Jollof Rice with Roast Chicken",image:"images/jollof-rice-with-roast-chicken.png",basePrice:2500,variants:[
        {size:"Plate",price:2500}]},
      {name:"Jollof Rice Only",image:"images/jollof-rice-only.png",basePrice:1500,variants:[
        {size:"Plate",price:1500}]},
      {name:"Aquafina",image:"images/aquafina.png",basePrice:800,variants:[
        {size:"Bottle",price:800}]},
      {name:"7Up",image:"images/7up.png",basePrice:800,variants:[
        {size:"Bottle",price:800}]},
      {name:"Pepsi",image:"images/pepsi.png",basePrice:800,variants:[
        {size:"Bottle",price:800}]},
      {name:"Mirinda Orange",image:"images/mirinda-orange.png",basePrice:800,variants:[
        {size:"Bottle",price:800}]},
      {name:"Teem Bitter Lemon",image:"images/teem-bitter-lemon.png",basePrice:800,variants:[
        {size:"Bottle",price:800}]},
      {name:"Chicken Wings 4pcs",image:"images/chicken-wings-4pcs.png",basePrice:4000,variants:[
        {size:"4pcs",price:4000}]},
      {name:"Chicken Wings 7pcs",image:"images/chicken-wings-7pcs.png",basePrice:7000,variants:[
        {size:"7pcs",price:7000}]},
      {name:"French Vanilla",image:"images/french-vanilla.png",basePrice:9900,variants:[
        {size:"Cup",price:9900}]},
      {name:"Cake Batter",image:"images/cake-batter.png",basePrice:9900,variants:[
        {size:"Cup",price:9900}]}
    ];

    // === DOM Elements ===
    const productGrid = document.getElementById("product-grid");
    const orderSummary = document.getElementById("order-summary");
    const totalQtyEl = document.getElementById("total-qty");
    const totalPriceEl = document.getElementById("total-price");

    const modal = document.getElementById("product-modal");
    const modalImage = document.getElementById("modal-image");
    const modalName = document.getElementById("modal-name");
    const modalPrice = document.getElementById("modal-price");
    const modalVariants = document.getElementById("modal-variants");
    const closeModal = document.getElementById("close-modal");

    let order = [];

    function renderProducts() {
      productGrid.innerHTML = "";
      products.forEach(p => {
        const card = document.createElement("div");
        card.className = "product-card";
        card.innerHTML = `
          <img src="${p.image}" alt="${p.name}">
          <h4>${p.name}</h4>
          <p>₦${p.basePrice.toLocaleString()}</p>
        `;
        card.addEventListener("click", () => openModal(p));
        productGrid.appendChild(card);
      });
    }

    function openModal(product) {
      modal.style.display = "flex";
      modalImage.src = product.image;
      modalName.textContent = product.name;
      modalPrice.textContent = "From ₦" + product.basePrice.toLocaleString();
      modalVariants.innerHTML = "";

      product.variants.forEach(v => {
        const row = document.createElement("div");
        row.className = "variant-row";
        row.innerHTML = `
          <span>${v.size}</span>
          <span>₦${v.price.toLocaleString()}</span>
          <input type="number" value="1" min="1" class="variant-qty">
          <button class="add-btn">Add</button>
        `;
        row.querySelector(".add-btn").addEventListener("click", () => {
          const qty = parseInt(row.querySelector(".variant-qty").value) || 1;
          updateOrder(product.name, v.size, qty, v.price);
          renderOrderSummary();
        });
        modalVariants.appendChild(row);
      });
    }

    closeModal.onclick = () => (modal.style.display = "none");
    window.onclick = e => { if (e.target === modal) modal.style.display = "none"; };

    function updateOrder(name, size, qty, price) {
      const existing = order.find(i => i.name === name && i.size === size);
      if (existing) {
        existing.quantity += qty;
        existing.total = existing.quantity * price;
      } else {
        order.push({ name, size, quantity: qty, price, total: qty * price });
      }
    }

    function renderOrderSummary() {
      orderSummary.innerHTML = "";
      let totalQty = 0, totalPrice = 0;
      order.forEach(i => {
        totalQty += i.quantity;
        totalPrice += i.total;
        const div = document.createElement("div");
        div.textContent = `${i.name} (${i.size}) x${i.quantity} = ₦${i.total.toLocaleString()}`;
        orderSummary.appendChild(div);
      });
      totalQtyEl.textContent = totalQty;
      totalPriceEl.textContent = totalPrice.toLocaleString();
    }

    document.getElementById("order-form").addEventListener("submit", e => {
      e.preventDefault();
      const orderData = {
        firstName: document.getElementById("first-name").value,
        lastName: document.getElementById("last-name").value,
        phone: document.getElementById("phone").value,
        childClass: document.getElementById("class").value,
        items: order
      };
      fetch("https://script.google.com/macros/s/AKfycbyH7J0MIoMtvw9bB-Tf2ldBGvhu6KIssyZyM3HKWMYvqXgZrp5kklTudFrK8CxhlRuF/exec", {
        method: "POST",
        body: JSON.stringify(orderData),
        headers: { "Content-Type": "application/json" }
      })
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            alert("Order submitted successfully!");
          } else {
            alert("Error: " + data.error);
          }
        })
        .catch(err => alert("Network error: " + err));
    });

    renderProducts();
  </script>
</body>
</html>

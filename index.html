<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Pizza Order Form</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 30px; }
    .item { margin-bottom: 20px; }
    .item button { margin-left: 10px; }
    #modalOverlay {
      display: none;
      position: fixed;
      top:0; left:0; right:0; bottom:0;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    #modal {
      background: white;
      padding: 20px;
      border-radius: 5px;
      width: 300px;
    }
    #summary, #formSection { margin-top: 30px; }
    table { border-collapse: collapse; }
    th, td { border: 1px solid #ddd; padding: 8px; }
    #orderSummaryPage { display: none; margin-top: 30px; }
  </style>
</head>
<body>

  <h1>Pizza Order</h1>

  <div id="itemsList">
    <!-- Example items -->
    <div class="item" data-name="Pepperoni">
      <span>Pepperoni Pizza</span>
      <button onclick="openModal('Pepperoni', { standard:10, large:13, xlarge:16 })">Order</button>
    </div>
    <div class="item" data-name="Margherita">
      <span>Margherita Pizza</span>
      <button onclick="openModal('Margherita', { standard:8, large:11, xlarge:14 })">Order</button>
    </div>
    <div class="item" data-name="Veggie">
      <span>Veggie Pizza</span>
      <button onclick="openModal('Veggie', { standard:9, large:12, xlarge:15 })">Order</button>
    </div>
  </div>

  <!-- Modal for size + quantity -->
  <div id="modalOverlay">
    <div id="modal">
      <h3 id="modalItemName"></h3>
      <div>
        <label><input type="radio" name="size" value="standard"> Standard (<span id="priceStandard"></span>)</label><br>
        <label><input type="radio" name="size" value="large"> Large (<span id="priceLarge"></span>)</label><br>
        <label><input type="radio" name="size" value="xlarge"> X-Large (<span id="priceXLarge"></span>)</label>
      </div>
      <div style="margin-top:10px;">
        <label>Quantity: <input type="number" id="qty" value="1" min="1"></label>
      </div>
      <div style="margin-top:10px;">
        <button onclick="addItem()">Add to Order</button>
        <button onclick="closeModal()">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Current order & form section -->
  <div id="summary">
    <h2>Your Order</h2>
    <div id="currentOrderItems">
      <!-- dynamically filled -->
    </div>
    <div>
      <strong>Total Quantity: </strong><span id="totalQty">0</span><br>
      <strong>Total Price: $</strong><span id="totalPrice">0.00</span>
    </div>
  </div>

  <div id="formSection">
    <h2>Your Details</h2>
    <form id="orderForm" onsubmit="return handleSubmit(event);">
      <div>
        <label>First Name: <input type="text" id="firstName" required></label>
      </div>
      <div>
        <label>Last Name: <input type="text" id="lastName" required></label>
      </div>
      <div>
        <label>Phone Number: <input type="text" id="phone" required></label>
      </div>
      <div>
        <label>Child’s Class: <input type="text" id="childClass" required></label>
      </div>
      <div style="margin-top:10px;">
        <button type="submit">Submit Order</button>
      </div>
    </form>
  </div>

  <!-- Order Summary Page -->
  <div id="orderSummaryPage">
    <h2>Order Summary</h2>
    <table id="summaryTable">
      <thead>
        <tr>
          <th>Name</th><th>Order Quantity</th><th>Amount to Pay</th>
        </tr>
      </thead>
      <tbody>
        <!-- rows filled dynamically -->
      </tbody>
    </table>
  </div>

<script>
  let currentOrder = [];
  let pricing = {}; // to hold price info for modal
  let modalItem = null;

  function openModal(itemName, priceObj) {
    modalItem = itemName;
    pricing = priceObj;
    document.getElementById('modalItemName').innerText = itemName;
    document.getElementById('priceStandard').innerText = priceObj.standard.toFixed(2);
    document.getElementById('priceLarge').innerText = priceObj.large.toFixed(2);
    document.getElementById('priceXLarge').innerText = priceObj.xlarge.toFixed(2);
    // reset selections
    document.querySelector('input[name="size"][value="standard"]').checked = true;
    document.getElementById('qty').value = 1;
    document.getElementById('modalOverlay').style.display = 'flex';
  }

  function closeModal() {
    document.getElementById('modalOverlay').style.display = 'none';
  }

  function addItem() {
    const size = document.querySelector('input[name="size"]:checked').value;
    const qty = parseInt(document.getElementById('qty').value, 10);
    const price = pricing[size] * qty;
    // add to currentOrder
    currentOrder.push({ item: modalItem, size, qty, price });
    updateSummary();
    closeModal();
  }

  function updateSummary() {
    const container = document.getElementById('currentOrderItems');
    container.innerHTML = '';
    let totalQty = 0;
    let totalPrice = 0;
    currentOrder.forEach((oi, idx) => {
      const div = document.createElement('div');
      div.innerText = `${oi.qty} × ${oi.size} ${oi.item} — $${oi.price.toFixed(2)}`;
      container.appendChild(div);
      totalQty += oi.qty;
      totalPrice += oi.price;
    });
    document.getElementById('totalQty').innerText = totalQty;
    document.getElementById('totalPrice').innerText = totalPrice.toFixed(2);
  }

  function handleSubmit(event) {
    event.preventDefault();
    const firstName = document.getElementById('firstName').value;
    const lastName  = document.getElementById('lastName').value;
    const phone     = document.getElementById('phone').value;
    const childClass= document.getElementById('childClass').value;

    const orderQty = currentOrder.reduce((sum, o) => sum + o.qty, 0);
    const orderTotal = currentOrder.reduce((sum, o) => sum + o.price, 0);

    const data = {
      firstName, lastName, phone, childClass,
      orderQty, orderTotal,
      items: currentOrder
    };

    // Send data to Google Sheets (you'll set this up)
    fetch('https://script.google.com/macros/s/AKfycbwOh7s_4joUaU09zsMda5uGZq815Qm-ZL3au0-H52U8RzOa1P2HgRTcy169KqnUhP4T/exec', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    })
    .then(resp => resp.json())
    .then(res => {
      // On success, show summary page
      showSummaryPage(data);
    })
    .catch(err => {
      alert('Error submitting order: ' + err);
    });

    return false;
  }

  function showSummaryPage(data) {
    document.getElementById('itemsList').style.display = 'none';
    document.getElementById('summary').style.display = 'none';
    document.getElementById('formSection').style.display = 'none';

    const summaryDiv = document.getElementById('orderSummaryPage');
    summaryDiv.style.display = 'block';
    const tbody = document.querySelector('#summaryTable tbody');
    tbody.innerHTML = '';

    // Put one row with name, total qty, total price
    const tr = document.createElement('tr');
    const tdName = document.createElement('td');
    tdName.innerText = data.firstName + ' ' + data.lastName;
    const tdQty = document.createElement('td');
    tdQty.innerText = data.orderQty;
    const tdAmt = document.createElement('td');
    tdAmt.innerText = '$' + data.orderTotal.toFixed(2);
    tr.appendChild(tdName);
    tr.appendChild(tdQty);
    tr.appendChild(tdAmt);
    tbody.appendChild(tr);

    // If you want up to 10 rows (for multiple orders?), you could iterate more.
  }
</script>

</body>
</html>
